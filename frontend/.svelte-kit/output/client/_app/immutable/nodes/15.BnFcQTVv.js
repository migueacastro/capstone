import{s as at,e as u,a as T,c as f,b as k,w as O,g as L,f as g,o as _,i as K,h as n,E as H,x as q,F as nt,n as Q,D as lt,k as rt,r as ot,t as tt,d as et,j as st}from"../chunks/scheduler.Cvxp15X3.js";import{S as it,i as ct}from"../chunks/index.RxifS9Fo.js";import{g as dt}from"../chunks/stores.DkxrROnu.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.dsa4NXrV.js";import{p as ut}from"../chunks/stores.C1zgh52b.js";import{g as W}from"../chunks/entry.C_b26GiN.js";import{e as X}from"../chunks/public.Cb3FOUtJ.js";function Y(o){let t,s=o[2].password[0]+"",a;return{c(){t=u("p"),a=tt(s),this.h()},l(e){t=f(e,"P",{class:!0});var l=k(t);a=et(l,s),l.forEach(g),this.h()},h(){_(t,"class","text-red-500")},m(e,l){K(e,t,l),n(t,a)},p(e,l){l&4&&s!==(s=e[2].password[0]+"")&&st(a,s)},d(e){e&&g(t)}}}function Z(o){let t,s=o[2].confirmPassword[0]+"",a;return{c(){t=u("p"),a=tt(s),this.h()},l(e){t=f(e,"P",{class:!0});var l=k(t);a=et(l,s),l.forEach(g),this.h()},h(){_(t,"class","text-red-500")},m(e,l){K(e,t,l),n(t,a)},p(e,l){l&4&&s!==(s=e[2].confirmPassword[0]+"")&&st(a,s)},d(e){e&&g(t)}}}function ft(o){var J,$;let t,s,a,e,l="Reset Password",I,v,r,b,A="Password",j,w,x,B,p,E,y="Confirm Password",m,h,M,z,S,V='<button type="Request" class="btn btn-xl variant-filled w-full">Reset Password</button>',F,G,i=((J=o[2])==null?void 0:J.password)&&Y(o),c=(($=o[2])==null?void 0:$.confirmPassword)&&Z(o);return{c(){t=u("div"),s=u("div"),a=u("form"),e=u("header"),e.textContent=l,I=T(),v=u("section"),r=u("label"),b=u("span"),b.textContent=A,j=T(),w=u("input"),x=T(),i&&i.c(),B=T(),p=u("label"),E=u("span"),E.textContent=y,m=T(),h=u("input"),M=T(),c&&c.c(),z=T(),S=u("footer"),S.innerHTML=V,this.h()},l(d){t=f(d,"DIV",{class:!0});var P=k(t);s=f(P,"DIV",{class:!0});var D=k(s);a=f(D,"FORM",{});var C=k(a);e=f(C,"HEADER",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-10t0ncd"&&(e.textContent=l),I=L(C),v=f(C,"SECTION",{class:!0});var U=k(v);r=f(U,"LABEL",{class:!0});var N=k(r);b=f(N,"SPAN",{"data-svelte-h":!0}),O(b)!=="svelte-1kvjhoz"&&(b.textContent=A),j=L(N),w=f(N,"INPUT",{type:!0,class:!0}),x=L(N),i&&i.l(N),N.forEach(g),B=L(U),p=f(U,"LABEL",{class:!0});var R=k(p);E=f(R,"SPAN",{"data-svelte-h":!0}),O(E)!=="svelte-icktzz"&&(E.textContent=y),m=L(R),h=f(R,"INPUT",{type:!0,class:!0}),M=L(R),c&&c.l(R),R.forEach(g),U.forEach(g),z=L(C),S=f(C,"FOOTER",{class:!0,"data-svelte-h":!0}),O(S)!=="svelte-1i6wdir"&&(S.innerHTML=V),C.forEach(g),D.forEach(g),P.forEach(g),this.h()},h(){_(e,"class","card-header text-center text-4xl font-bold"),_(w,"type","password"),_(w,"class","input"),_(r,"class","label my-1"),_(h,"type","password"),_(h,"class","input"),_(p,"class","label my-1"),_(v,"class","p-4"),_(S,"class","card-footer"),_(s,"class","card m-4"),_(t,"class","container h-full mx-auto flex justify-center items-center")},m(d,P){K(d,t,P),n(t,s),n(s,a),n(a,e),n(a,I),n(a,v),n(v,r),n(r,b),n(r,j),n(r,w),H(w,o[0]),n(r,x),i&&i.m(r,null),n(v,B),n(v,p),n(p,E),n(p,m),n(p,h),H(h,o[1]),n(p,M),c&&c.m(p,null),n(a,z),n(a,S),F||(G=[q(w,"input",o[4]),q(h,"input",o[5]),q(a,"submit",nt(o[3]))],F=!0)},p(d,[P]){var D,C;P&1&&w.value!==d[0]&&H(w,d[0]),(D=d[2])!=null&&D.password?i?i.p(d,P):(i=Y(d),i.c(),i.m(r,null)):i&&(i.d(1),i=null),P&2&&h.value!==d[1]&&H(h,d[1]),(C=d[2])!=null&&C.confirmPassword?c?c.p(d,P):(c=Z(d),c.c(),c.m(p,null)):c&&(c.d(1),c=null)},i:Q,o:Q,d(d){d&&g(t),i&&i.d(),c&&c.d(),F=!1,lt(G)}}}function pt(o,t,s){let a;rt(o,ut,y=>s(6,a=y));const e=a.params,l=e.uidb64,I=e.token,v=dt();let r="",b="",A={confirmPassword:null};const j=async()=>{if(r!=b){s(2,A.confirmPassword=["Passwords do not match."],A);return}let y=`${X.PUBLIC_BACKEND_URL}/password-reset-complete`;await fetch(y,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r,uidb64:l,token:I}),credentials:"include"}).then(m=>m.json().then(h=>({status:m.status,body:h}))).then(m=>{m.status==200?(W("/"),v.trigger(w)):v.trigger(x)})};let w={message:"Password successfully reset.",background:"variant-filled-success"},x={message:"Error resetting password.",background:"variant-filled-error"},B={message:"Invalid link.",background:"variant-filled-error"};ot(async()=>{let y=`${X.PUBLIC_BACKEND_URL}/password-reset/${l}/${I}`;await fetch(y,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(m=>m.json().then(h=>({status:m.status,body:h}))).then(m=>{if(m.status!=200)W("/"),v.trigger(B);else return})});function p(){r=this.value,s(0,r)}function E(){b=this.value,s(1,b)}return[r,b,A,j,p,E]}class Pt extends it{constructor(t){super(),ct(this,t,pt,ft,at,{})}}export{Pt as component};
