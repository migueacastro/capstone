<script generics="T extends BaseChartOptions">import { onMount, afterUpdate, onDestroy, createEventDispatcher } from "svelte";
const chartHolderCssClass = "cds--chart-holder";
export let data = [];
export let options = {};
export let Chart;
export let chart;
export let ref;
export let id = `chart-${Math.random().toString(36)}`;
const dispatch = createEventDispatcher();
onMount(() => {
  try {
    chart = new Chart(ref, { data, options });
    dispatch("load");
  } catch (error) {
    console.error("Failed to initialize chart:", error);
  }
});
afterUpdate(() => {
  if (chart) {
    try {
      chart.model.setData(data);
      chart.model.setOptions(options);
      dispatch("update", { data, options });
    } catch (error) {
      console.error("Failed to update chart:", error);
    }
  }
});
onDestroy(() => {
  if (chart) {
    dispatch("destroy");
    chart.components.forEach((component) => component.destroy());
    chart.model.set({ destroyed: true }, { skipUpdate: true });
    chart = void 0;
  }
});
</script>

<div {id} bind:this={ref} class={chartHolderCssClass} {...$$restProps} />
